<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ë‹¤ì´ì•„ë¶€ë™ì‚° ë¹ ë¥¸ í™•ì¸</title>
  <meta name="theme-color" content="#c9a040" />
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="icon" href="icons/icon-192.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="ë‹¤ì´ì•„ë¶€ë™ì‚°">
  <link rel="apple-touch-icon" href="icons/apple-touch-icon.png">
  <style>
    body { font-family: sans-serif; margin:0; padding:20px; background:#fdfdfd; color:#222; text-align:center;}
    h1 { font-size:22px; margin:16px 0 20px 0; }
    .logo { margin:20px auto; }
    .logo img { max-width:120px; height:auto; }
    .section { margin:28px 0; text-align:left; display:inline-block; max-width:600px; width:100%; }
    .row { display: flex; gap: 10px; }
    input, textarea { flex: 1; padding: 10px; font-size: 15px; border:1px solid #ccc; border-radius:6px; }
    button { padding: 10px 16px; font-size:15px; border:none; border-radius:6px; background:#c9a040; color:#fff; cursor:pointer; }
    button:hover { background:#b38d36; }
    .logout { margin-top:20px; background:#555 !important; }
    footer {margin-top:30px; font-size:12px; color:#555;}
  </style>
</head>
<body>

<!-- ğŸ”’ ë¡œê·¸ì¸ ì²´í¬ -->
<script>
  if(localStorage.getItem("dia_login") !== "ok"){
    window.location.href = "login.html";
  }

  function logout(){
    localStorage.removeItem("dia_login");
    window.location.href = "login.html";
  }
</script>

  <div class="logo"><img src="icons/icon-192.png" alt="DIA logo"></div>
  <h1>ë‹¤ì´ì•„ë¶€ë™ì‚° ë§¤ë¬¼ ë¹ ë¥¸ í™•ì¸</h1>

  <!-- ğŸ”˜ ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ -->
  <button class="logout" onclick="logout()">ë¡œê·¸ì•„ì›ƒ</button>

  <div class="section">
    <h3>ë§¤ë¬¼ë²ˆí˜¸ë¡œ í™•ì¸</h3>
    <div class="row">
      <textarea id="ids" placeholder="ì˜ˆ: 2541088852, 2539865439" inputmode="numeric"></textarea>
      <button onclick="openById()">ì—´ê¸°</button>
    </div>
  </div>

  <div class="section">
    <h3>ì£¼ì†Œë¡œ ê²€ìƒ‰</h3>
    <div class="row">
      <input type="text" id="addr" placeholder="ì˜ˆ: ì²­ì´ˆë¡œ 66" />
      <button onclick="searchByAddress()">ê²€ìƒ‰</button>
    </div>
  </div>

  <footer>Â© 2025 ë‹¤ì´ì•„ë¶€ë™ì‚° QuickLink PWA</footer>

<script>
function openById(){
  const raw=document.getElementById('ids').value;
  const ids=raw.split(/[\s,\n]+/).filter(Boolean);
  if(!ids.length){alert("ë§¤ë¬¼ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”");return;}
  ids.forEach((id,i)=>{
    setTimeout(()=>{
      window.open('https://m.land.naver.com/article/info/'+encodeURIComponent(id),'_blank');
    },i*200);
  });
}

async function searchByAddress(){
  const addr = document.getElementById('addr').value.trim();
  if(!addr){ 
    alert("ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”"); 
    return; 
  }

  try {
    const res = await fetch(`/api/geocode?query=${encodeURIComponent(addr)}`);
    const data = await res.json();

    if (data.lat && data.lon) {
      // ì¹´ì¹´ì˜¤ë§µìœ¼ë¡œ ì—´ê¸°
      const url = `https://map.kakao.com/link/map/${encodeURIComponent(addr)},${data.lat},${data.lon}`;
      window.open(url, '_blank');
    } else {
      alert("ì£¼ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
    }
  } catch(err) {
    alert("API ì˜¤ë¥˜: " + err.message);
  }
}


if("serviceWorker" in navigator){ navigator.serviceWorker.register("sw.js").catch(()=>{}); }
</script>

</body>
</html>
