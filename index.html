<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>다이아부동산 빠른 확인</title>
  <meta name="theme-color" content="#c9a040" />
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="icon" href="icons/icon-192.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="다이아부동산">
  <link rel="apple-touch-icon" href="icons/apple-touch-icon.png">
  <style>
    body { font-family: sans-serif; margin:0; padding:20px; background:#fdfdfd; color:#222; text-align:center;}
    h1 { font-size:22px; margin:16px 0 20px 0; }
    .logo { margin:20px auto; }
    .logo img { max-width:120px; height:auto; }
    .section { margin:28px 0; text-align:left; display:inline-block; max-width:600px; width:100%; }
    .row { display: flex; gap: 10px; }
    input, textarea { flex: 1; padding: 10px; font-size: 15px; border:1px solid #ccc; border-radius:6px; }
    button { padding: 10px 16px; font-size:15px; border:none; border-radius:6px; background:#c9a040; color:#fff; cursor:pointer; }
    button:hover { background:#b38d36; }
    h3 { margin-bottom:10px; }
    footer {margin-top:30px; font-size:12px; color:#555;}
  </style>
</head>
<body>
  <div class="logo"><img src="icons/icon-192.png" alt="DIA logo"></div>
  <h1>다이아부동산 매물 빠른 확인</h1>

  <div class="section">
    <h3>매물번호로 확인</h3>
    <div class="row">
      <textarea id="ids" placeholder="예: 2541088852, 2539865439" inputmode="numeric"></textarea>
      <button onclick="openById()">열기</button>
    </div>
  </div>

  <div class="section">
    <h3>주소로 검색</h3>
    <div class="row">
      <input type="text" id="addr" placeholder="예: 청초로 66" />
      <button onclick="searchByAddress()">검색</button>
    </div>
  </div>

  <footer>© 2025 다이아부동산 QuickLink PWA</footer>

<script>
function openById(){
  const raw=document.getElementById('ids').value;
  const ids=raw.split(/[\s,\n]+/).filter(Boolean);
  if(!ids.length){alert("매물번호를 입력하세요");return;}
  ids.forEach((id,i)=>{
    setTimeout(()=>{
      window.open('https://m.land.naver.com/article/info/'+encodeURIComponent(id),'_blank');
    },i*200);
  });
}
async function searchByAddress(){
  const addr=document.getElementById('addr').value.trim();
  if(!addr){alert("주소를 입력하세요");return;}
  try{
    const res=await fetch(`/api/geocode?query=${encodeURIComponent(addr)}`);
    const data=await res.json();
    if(data.lat && data.lon){
      const url=`https://m.land.naver.com/map/아파트?lat=${data.lat}&lon=${data.lon}&zoom=18`;
      window.open(url,'_blank');
    }else{
      alert("검색 결과가 없습니다. 입력: "+addr);
    }
  }catch(err){
    alert("API 호출 오류: "+err.message);
  }
}
if("serviceWorker" in navigator){ navigator.serviceWorker.register("sw.js").catch(()=>{}); }
</script>
</body>
</html>
